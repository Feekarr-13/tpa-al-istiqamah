import  { useState, useEffect } from "react";
import "./PrayerTimes.css";

const PrayerTimeApp = () => {
  const [prayerTimes, setPrayerTimes] = useState({
    fajar: "4:21 AM",
    dzuhr: "11:49 AM",
    asar: "3:17 PM",
    maghrib: "6:00 PM",
    isha: "7:17 PM",
    sunrise: "5:38 AM",
    sunset: "5:54 PM",
    jumma: "12:30 PM"
  });

  useEffect(() => {
    // Mengambil zona waktu lokal pengguna
    const localTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;

    // Fungsi untuk memvalidasi dan mengubah waktu sesuai zona waktu
    const adjustTimeForTimezone = (timeString) => {
      // Membuat Date object dari waktu yang diberikan
      const time = new Date(`1970-01-01T${timeString}Z`); // Menggunakan tanggal tetap agar waktu terkonversi dengan benar

      // Mengecek apakah objek Date valid
      if (isNaN(time)) {
        console.error("Invalid time:", timeString);
        return timeString; // Mengembalikan waktu asli jika tidak valid
      }

      const options = {
        timeZone: localTimeZone,
        hour: "2-digit",
        minute: "2-digit",
        hour12: true
      };

      return new Intl.DateTimeFormat("en-US", options).format(time);
    };

    // Memperbarui waktu salat berdasarkan zona waktu lokal
    const updatedTimes = {
      fajar: adjustTimeForTimezone("04:04 AM"),
      dzuhr: adjustTimeForTimezone("11:49 AM"),
      asar: adjustTimeForTimezone("15:00 PM"),
      maghrib: adjustTimeForTimezone("17:39 PM"),
      isha: adjustTimeForTimezone("18:10 PM"),
      sunrise: adjustTimeForTimezone("5:00 AM"),
      sunset: adjustTimeForTimezone("17:30 PM"),
      jumma: adjustTimeForTimezone("12:15 PM")
    };

    console.log(updatedTimes); // Debugging untuk memastikan waktu sudah terupdate
    setPrayerTimes(updatedTimes);
  }, []);

  return (
    <div className="prayer-time-app">
      {/* Date Section */}
      <div className="date-section">
        <div>
          <p>Sunday, September 12, 2021 (<span className="islamic-date">03 Safar 1443</span>)</p>
        </div>
        <div>
          <p>Friday, Sept 17, 2021 (<span className="islamic-date">08 Safar 1443</span>)</p>
        </div>
      </div>

      {/* Main Container */}
      <div className="main-container">
        {/* Left Column */}
        <div className="left-column">
          {/* Sunrise Time */}
          <div className="sunrise-box">
            <span role="img" aria-label="sunrise"><svg xmlns="http://www.w3.org/2000/svg" width="31" height="30" viewBox="0 0 31 30" fill="none">
            <circle cx="15.8989" cy="15" r="15" fill="white"/><svg xmlns="http://www.w3.org/2000/svg" width="25" height="24" viewBox="0 0 25 24" fill="none">
            <path d="M18.8989 12C18.8989 13.5913 18.2668 15.1174 17.1416 16.2426C16.0163 17.3679 14.4902 18 12.8989 18C11.3076 18 9.7815 17.3679 8.65629 16.2426C7.53107 15.1174 6.89893 13.5913 6.89893 12C6.89893 10.4087 7.53107 8.88258 8.65629 7.75736C9.7815 6.63214 11.3076 6 12.8989 6C14.4902 6 16.0163 6.63214 17.1416 7.75736C18.2668 8.88258 18.8989 10.4087 18.8989 12Z" fill="#FFC265"/>
            <path fillRule="evenodd" clipRule="evenodd" d="M12.8989 1.25C13.0978 1.25 13.2886 1.32902 13.4293 1.46967C13.5699 1.61032 13.6489 1.80109 13.6489 2V3C13.6489 3.19891 13.5699 3.38968 13.4293 3.53033C13.2886 3.67098 13.0978 3.75 12.8989 3.75C12.7 3.75 12.5092 3.67098 12.3686 3.53033C12.2279 3.38968 12.1489 3.19891 12.1489 3V2C12.1489 1.80109 12.2279 1.61032 12.3686 1.46967C12.5092 1.32902 12.7 1.25 12.8989 1.25ZM2.14893 12C2.14893 11.8011 2.22794 11.6103 2.3686 11.4697C2.50925 11.329 2.70001 11.25 2.89893 11.25H3.89893C4.09784 11.25 4.2886 11.329 4.42926 11.4697C4.56991 11.6103 4.64893 11.8011 4.64893 12C4.64893 12.1989 4.56991 12.3897 4.42926 12.5303C4.2886 12.671 4.09784 12.75 3.89893 12.75H2.89893C2.70001 12.75 2.50925 12.671 2.3686 12.5303C2.22794 12.3897 2.14893 12.1989 2.14893 12ZM21.1489 12C21.1489 11.8011 21.2279 11.6103 21.3686 11.4697C21.5092 11.329 21.7 11.25 21.8989 11.25H22.8989C23.0978 11.25 23.2886 11.329 23.4293 11.4697C23.5699 11.6103 23.6489 11.8011 23.6489 12C23.6489 12.1989 23.5699 12.3897 23.4293 12.5303C23.2886 12.671 23.0978 12.75 22.8989 12.75H21.8989C21.7 12.75 21.5092 12.671 21.3686 12.5303C21.2279 12.3897 21.1489 12.1989 21.1489 12ZM12.8989 20.25C13.0978 20.25 13.2886 20.329 13.4293 20.4697C13.5699 20.6103 13.6489 20.8011 13.6489 21V22C13.6489 22.1989 13.5699 22.3897 13.4293 22.5303C13.2886 22.671 13.0978 22.75 12.8989 22.75C12.7 22.75 12.5092 22.671 12.3686 22.5303C12.2279 22.3897 12.1489 22.1989 12.1489 22V21C12.1489 20.8011 12.2279 20.6103 12.3686 20.4697C12.5092 20.329 12.7 20.25 12.8989 20.25Z" fill="#F19F01"/>
            <path opacity="0.5" d="M5.29679 4.39806C5.36644 4.32837 5.44914 4.27308 5.54017 4.23536C5.63119 4.19764 5.72876 4.17822 5.82729 4.17822C5.92582 4.17822 6.02339 4.19764 6.11441 4.23536C6.20544 4.27308 6.28814 4.32837 6.35779 4.39806L6.75079 4.79106C6.88327 4.93324 6.95539 5.12128 6.95197 5.31559C6.94854 5.50989 6.86983 5.69527 6.73241 5.83268C6.595 5.9701 6.40961 6.04881 6.21531 6.05224C6.02101 6.05567 5.83297 5.98354 5.69079 5.85106L5.29679 5.45906C5.15634 5.31844 5.07745 5.12781 5.07745 4.92906C5.07745 4.73031 5.15634 4.53969 5.29679 4.39906M20.4988 4.39906C20.6392 4.53969 20.7181 4.73031 20.7181 4.92906C20.7181 5.12781 20.6392 5.31844 20.4988 5.45906L20.1068 5.85206C19.9646 5.98454 19.7766 6.05667 19.5823 6.05324C19.388 6.04981 19.2026 5.9711 19.0652 5.83368C18.9278 5.69627 18.849 5.51089 18.8456 5.31659C18.8422 5.12228 18.9143 4.93424 19.0468 4.79206L19.4388 4.39906C19.5794 4.25861 19.77 4.17972 19.9688 4.17972C20.1675 4.17972 20.3582 4.25861 20.4988 4.39906ZM19.0458 18.1471C19.1154 18.0774 19.1981 18.0221 19.2892 17.9844C19.3802 17.9466 19.4778 17.9272 19.5763 17.9272C19.6748 17.9272 19.7724 17.9466 19.8634 17.9844C19.9544 18.0221 20.0371 18.0774 20.1068 18.1471L20.4998 18.5401C20.6323 18.6822 20.7044 18.8703 20.701 19.0646C20.6975 19.2589 20.6188 19.4443 20.4814 19.5817C20.344 19.7191 20.1586 19.7978 19.9643 19.8012C19.77 19.8047 19.582 19.7325 19.4398 19.6001L19.0458 19.2081C18.9053 19.0674 18.8265 18.8768 18.8265 18.6781C18.8265 18.4793 18.9053 18.2887 19.0458 18.1481M6.75079 18.1481C6.89124 18.2887 6.97013 18.4793 6.97013 18.6781C6.97013 18.8768 6.89124 19.0674 6.75079 19.2081L6.35779 19.6011C6.28913 19.6747 6.20633 19.7339 6.11433 19.7748C6.02233 19.8158 5.92302 19.8379 5.82231 19.8397C5.72161 19.8414 5.62158 19.8229 5.52819 19.7852C5.4348 19.7475 5.34997 19.6913 5.27875 19.6201C5.20753 19.5489 5.15139 19.464 5.11367 19.3707C5.07595 19.2773 5.05742 19.1772 5.0592 19.0765C5.06098 18.9758 5.08302 18.8765 5.12401 18.7845C5.165 18.6925 5.2241 18.6097 5.29779 18.5411L5.68979 18.1481C5.83042 18.0076 6.02104 17.9287 6.21979 17.9287C6.41854 17.9287 6.60916 18.0076 6.74979 18.1481" fill="#F19F01"/>
          </svg>
</        svg></span> Sun Rise <span className="time">{prayerTimes.sunrise}</span>
          </div>

          {/* Salah Timings */}
          <div className="salah-timings">
            <div className="salah-heading">
              <p>Salah</p>
              <p>Begins</p>
              <p>Iqomah</p>
            </div>
            <div className="salah-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4ZM12 6C12.2449 6.00003 12.4813 6.08996 12.6644 6.25272C12.8474 6.41547 12.9643 6.63975 12.993 6.883L13 7V11.586L15.707 14.293C15.8863 14.473 15.9905 14.7144 15.9982 14.9684C16.006 15.2223 15.9168 15.4697 15.7488 15.6603C15.5807 15.8508 15.3464 15.9703 15.0935 15.9944C14.8406 16.0185 14.588 15.9454 14.387 15.79L14.293 15.707L11.293 12.707C11.1376 12.5514 11.0378 12.349 11.009 12.131L11 12V7C11 6.73478 11.1054 6.48043 11.2929 6.29289C11.4804 6.10536 11.7348 6 12 6Z" fill="#1DA599"/>
            </svg><span>Fajar</span><span>{prayerTimes.fajar}</span><span>4:15 AM</span></div>
            <div className="salah-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4ZM12 6C12.2449 6.00003 12.4813 6.08996 12.6644 6.25272C12.8474 6.41547 12.9643 6.63975 12.993 6.883L13 7V11.586L15.707 14.293C15.8863 14.473 15.9905 14.7144 15.9982 14.9684C16.006 15.2223 15.9168 15.4697 15.7488 15.6603C15.5807 15.8508 15.3464 15.9703 15.0935 15.9944C14.8406 16.0185 14.588 15.9454 14.387 15.79L14.293 15.707L11.293 12.707C11.1376 12.5514 11.0378 12.349 11.009 12.131L11 12V7C11 6.73478 11.1054 6.48043 11.2929 6.29289C11.4804 6.10536 11.7348 6 12 6Z" fill="#1DA599"/>
            </svg><span>Dzuhr</span><span>{prayerTimes.dzuhr}</span><span>11:55 PM</span></div>
            <div className="salah-time active"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4ZM12 6C12.2449 6.00003 12.4813 6.08996 12.6644 6.25272C12.8474 6.41547 12.9643 6.63975 12.993 6.883L13 7V11.586L15.707 14.293C15.8863 14.473 15.9905 14.7144 15.9982 14.9684C16.006 15.2223 15.9168 15.4697 15.7488 15.6603C15.5807 15.8508 15.3464 15.9703 15.0935 15.9944C14.8406 16.0185 14.588 15.9454 14.387 15.79L14.293 15.707L11.293 12.707C11.1376 12.5514 11.0378 12.349 11.009 12.131L11 12V7C11 6.73478 11.1054 6.48043 11.2929 6.29289C11.4804 6.10536 11.7348 6 12 6Z" fill="white"/>
            </svg><span>Asar</span><span>{prayerTimes.asar}</span><span>15:14 PM</span></div>
            <div className="salah-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4ZM12 6C12.2449 6.00003 12.4813 6.08996 12.6644 6.25272C12.8474 6.41547 12.9643 6.63975 12.993 6.883L13 7V11.586L15.707 14.293C15.8863 14.473 15.9905 14.7144 15.9982 14.9684C16.006 15.2223 15.9168 15.4697 15.7488 15.6603C15.5807 15.8508 15.3464 15.9703 15.0935 15.9944C14.8406 16.0185 14.588 15.9454 14.387 15.79L14.293 15.707L11.293 12.707C11.1376 12.5514 11.0378 12.349 11.009 12.131L11 12V7C11 6.73478 11.1054 6.48043 11.2929 6.29289C11.4804 6.10536 11.7348 6 12 6Z" fill="#1DA599"/>
            </svg><span>Maghrib</span><span>{prayerTimes.maghrib}</span><span>17:54 PM</span></div>
            <div className="salah-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4ZM12 6C12.2449 6.00003 12.4813 6.08996 12.6644 6.25272C12.8474 6.41547 12.9643 6.63975 12.993 6.883L13 7V11.586L15.707 14.293C15.8863 14.473 15.9905 14.7144 15.9982 14.9684C16.006 15.2223 15.9168 15.4697 15.7488 15.6603C15.5807 15.8508 15.3464 15.9703 15.0935 15.9944C14.8406 16.0185 14.588 15.9454 14.387 15.79L14.293 15.707L11.293 12.707C11.1376 12.5514 11.0378 12.349 11.009 12.131L11 12V7C11 6.73478 11.1054 6.48043 11.2929 6.29289C11.4804 6.10536 11.7348 6 12 6Z" fill="#1DA599"/>
            </svg><span>Isha</span><span>{prayerTimes.isha}</span><span>19:10 PM</span></div>
          </div>

                    {/* Sunset Time */}
                    <div className="sunset-box">
                      <span role="img" aria-label="sunset"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <g clipPath="url(#clip0_373_190)">
              <path d="M15.22 6.03L17.75 4.09L14.56 4L13.5 1L12.44 4L9.25 4.09L11.78 6.03L10.87 9.09L13.5 7.28L16.13 9.09L15.22 6.03Z" fill="#FFF700" />
              <path
                d="M7 5.99994C7 12.0799 11.92 16.9999 18 16.9999C18.53 16.9999 19.05 16.9599 19.56 16.8899C17.95 19.3599 15.17 20.9999 12 20.9999C7.03 20.9999 3 16.9699 3 11.9999C3 8.82994 4.64 6.04994 7.11 4.43994C7.04 4.94994 7 5.46994 7 5.99994Z"
                fill="#FFF700"
                stroke="#FFF700"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </g>
          </svg>
          </span> Sunset <span className="time">{prayerTimes.sunset}</span>
                    </div>
                  </div>
          {/* Right Column */}
          <div className="right-column">
            {/* Jumma Khutbah */}
            <div className="jumma-khutbah">
              <p>Regular study every Friday after Asar with Ustadz Ali Abdul Latif</p>
              <div className="khatib-info">
                {/* Menambahkan gambar */}
                <img 
                  className="khatib-image" 
                  src="/assets/Foto.jpg" 
                  alt="Foto Khatib" 
                />
                <p>Abdur Razzak Bin Yusuf</p>
                <p>Founder of Al-Jamid&apos;rah As-Salafiyah Madrasah, Dhaka, Bangladesh</p>
              </div>
              <div className="khutbah-timing">
                Jumma Khutbah Begins at <span className="time">{prayerTimes.jumma}</span>
              </div>
            </div>


          {/* Friday Event */}
          <div className="friday-event">
            <p>Friday Event<span>Time</span></p>
            <div className="event-time">
              <span>Live Questions</span><span>2:00 PM</span>
            </div>
            <div className="event-time">
              <span>Islamic Halaqo</span><span>7:00 PM</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default PrayerTimeApp;
